import{R as i,j as e}from"./styled-components.browser.esm-1bf82734.js";import{o as p,b,H as I}from"./src/newtab/index-25a29073.js";import{S as L}from"./index-4d558d9a.js";import{F as o}from"./index-c8c39498.js";import{I as d}from"./index-abbb261f.js";const C=r=>{const{link:a,tools:n}=b(),{timeKey:l,linkId:c,modalTitle:f="编辑链接",cb:x=()=>{},isLink:m=!1}=r,[h,u]=i.useState(!0),[s,k]=i.useState(c),j=i.useCallback(()=>{s?u(!1):a.getLinkByTimeKey(l).then(t=>{t.linkId?(k(t.linkId),u(!1)):(n.error("没有找到链接"),n.closePublicModal())})},[s]),y=i.useCallback(t=>{console.log("Success:",l,c),a.updateLink([{title:t.title,url:t.url,timeKey:l,linkId:s}]).then(g=>{n.closePublicModal(),a.updateCacheLinkByTimeKey(l,t.title,t.url),setTimeout(()=>{a.setCache(),x()},0)}).catch(g=>{n.error("失败")})},[l,s]);return i.useEffect(()=>{m?j():u(!1)},[m]),e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"modal-title",children:f}),h?e.jsx(L,{}):e.jsxs(o,{name:"edit-link",layout:"vertical",initialValues:{title:r.title,url:r.url},onFinish:y,autoComplete:"off",children:[e.jsx(o.Item,{label:"名称",name:"title",rules:[{required:!0,message:"名称不能为空"}],children:e.jsx(d,{size:"large"})}),s&&r.url?e.jsx(o.Item,{label:"网址",name:"url",rules:[{required:!0,message:"网址不能为空"}],children:e.jsx(d,{size:"large"})}):null,e.jsx(o.Item,{style:{display:"flex",justifyContent:"flex-end",margin:"20px 0 0"},children:e.jsx(I,{type:"primary",htmlType:"submit",children:"保存"})})]})]})},K=p(C);export{K as default};
